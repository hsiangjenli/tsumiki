---
description: 為 TDD 開發篩選測試案例。根據整理過的需求找出完整的測試案例。
---
你是測試設計負責人。請檢視指定 task_id 的需求，並建立具高度覆蓋率的測試案例。

# TDD 測試案例篩選

根據剛整理的需求，列出能充分涵蓋需求與功能的測試案例。

## 前置準備

請先整理開發脈絡：

1. **讀取追加規範**
   - 若存在 `docs/rule` 目錄，請讀取
   - 若存在 `docs/rule/tdd` 目錄，請讀取  
   - 若存在 `docs/rule/tdd/testcases` 目錄，請讀取
   - 讀取各目錄內所有檔案並作為追加規範套用

2. **使用 @agent-symbol-searcher 搜尋測試相關資訊並讀取**
   - 搜尋既有測試樣式與測試案例，並使用 Read 工具讀取對應測試檔案
   - 找出類似功能的測試方式與模擬策略，並使用 Read 工具讀取相關檔案
   - 確認測試框架的使用方式，並讀取設定檔

3. **直接讀取相關檔案**
   - `docs/implements/{要件名}/{{task_id}}/{feature_name}-memo.md`：確認既有開發紀錄
   - `docs/implements/{要件名}/{{task_id}}/{feature_name}-requirements.md`：確認需求定義
   - `docs/implements/{要件名}/{{task_id}}/{feature_name}-testcases.md`：確認既有測試案例
   - 視需要讀取相關設計文件與任務檔案

完成讀取後，依據已準備的脈絡資訊開始篩選測試案例。

## 信賴等級指引

為每個測試案例加上註解，說明其與原始資料（需求定義、既有實作、程式庫文件等）的對照狀態：

- 🔵 **藍燈**：幾乎完全依據原始資料，無須推測
- 🟡 **黃燈**：根據原始資料合理推測
- 🔴 **紅燈**：原始資料中無對應內容，需自行推測

## 測試案例分類

### 1. 正常情境（基本運作）

請以下列格式描述：

- **測試名稱**：[易懂的日文名稱]
  - **測試重點**：[此測試要驗證的具體行為或功能]
  - **預期行為**：[應正常執行的流程]
- **輸入值**：[具體數值]
  - **輸入意義**：[為何選用此輸入、代表的情境]
- **預期結果**：[具體期待值]
  - **理由**：[為何判定此結果正確]
- **測試目的**：[驗證重點]
  - **檢查要點**：[需特別留意的部分]
- 🔵🟡🔴 註記信賴等級

### 2. 異常情境（錯誤處理）

- **測試名稱**：[易懂的日文名稱]
  - **異常概述**：[預期發生的異常情境]
  - **錯誤處理的重要性**：[為何需要此錯誤處理]
- **輸入值**：[不合法或超出邊界的數值]
  - **不合法原因**：[判定為異常的理由]
  - **實際情境**：[真實環境中可能的發生場景]
- **預期結果**：[適當的錯誤訊息或例外]
  - **錯誤訊息內容**：[訊息是否易於理解]
  - **系統安全性**：[錯誤發生時系統能否維持安全狀態]
- **測試目的**：[檢查錯誤處理]
  - **品質觀點**：[此測試對品質的貢獻]
- 🔵🟡🔴 註記信賴等級

### 3. 邊界值（最小值、最大值、null 等）

- **測試名稱**：[易懂的日文名稱]
  - **邊界值意義**：[為何此值重要]
  - **邊界行為保障**：[確認邊界附近的穩定度]
- **輸入值**：[邊界值]
  - **選用根據**：[為何將此值視為邊界]
  - **實務情境**：[邊界值在實務中的影響]
- **預期結果**：[邊界下的動作]
  - **精確性**：[計算或處理是否精準]
  - **一致性**：[邊界內外的動作是否一致]
- **測試目的**：[驗證邊界條件]
  - **穩健性**：[系統在極端條件下是否穩定]
- 🔵🟡🔴 註記信賴等級

## 開發語言與框架

請同時指定實作時使用的語言與測試框架：

- **程式語言**：{{language}}
  - **選擇理由**：[為何選擇此語言]
  - **測試優勢**：[此語言對測試的優點]
- **測試框架**：{{test_framework}}
  - **選擇理由**：[為何選擇此框架]
  - **執行環境**：[預期運行測試的環境]
- 🔵🟡🔴 註記信賴等級

## 實作測試案例時的日文註解指引

在實作各測試案例時，請務必加入以下日文註解：

### 測試案例開頭

```javascript
// 【テスト目的】: [請用日文明確敘述此測試要確認的內容]
// 【テスト内容】: [說明要測試的具體流程]
// 【期待される動作】: [說明預期結果]
// 🔵🟡🔴 この内容の信頼性レベル: [註記可靠度]
```

### Given（準備階段）

```javascript
// 【テストデータ準備】: [說明為何需要這組資料]
// 【初期条件設定】: [描述測試前的狀態]
// 【前提条件確認】: [明確必要的前置條件]
```

### When（操作階段）

```javascript
// 【操作内容】: [說明執行的操作]
// 【処理対象】: [說明操作的對象]
// 【操作理由】: [說明此操作與測試目的的關聯]
```

### Then（驗證階段）

```javascript
// 【期待値】: [說明預期的值或狀態]
// 【検証項目】: [說明要檢查的具體項目]
// 【結果の解釈】: [說明結果代表的意義]
```

## テストケース記録テンプレート

`docs/implements/{要件名}/{{task_id}}/{feature_name}-testcases.md` 應使用以下格式：

```markdown
# テストケース定義: {feature_name}

## 概要
- 機能名: [功能名稱]
- 想定ユーザー: [預期使用者]
- 開発対象: [開發目標]
- 対応言語・フレームワーク: [使用語言／框架]

## テスト分類
- 正常系: [件数]
- 異常系: [件数]
- 境界値: [件数]
- E2E: [件数]
- ユニット: [件数]

## テストケース一覧

### 正常系
1. **テスト名**: [日文名稱]
   - テスト目的: [用途]
   - 入力: [值]
   - 期待結果: [結果]
   - コメント: [補充說明]
   - 🔵🟡🔴 信頼性レベル: [標示]

### 異常系
1. **テスト名**: [日文名稱]
   - エラーケース: [描述]
   - 入力: [值]
   - 期待結果: [結果]
   - コメント: [補充說明]
   - 🔵🟡🔴 信頼性レベル: [標示]

### 境界値
1. **テスト名**: [日文名稱]
   - 境界値: [值]
   - 入力: [值]
   - 期待結果: [結果]
   - コメント: [補充說明]
   - 🔵🟡🔴 信頼性レベル: [標示]
```

## テストケース優先順位付け

テストケースには優先度を設定してください：

- **P0（最優先）**: 重大障害を防ぐテスト
- **P1（高優先度）**: 主要機能の品質保証
- **P2（中優先度）**: ユーザー体験向上
- **P3（低優先度）**: 将来の改善枠

各優先度の理由も記載し、信賴等級を明示してください。

## テストカバレッジ

- **機能カバレッジ**: どの機能をカバーするか
- **入力カバレッジ**: 入力データの幅
- **パスカバレッジ**: 処理経路の網羅
- **例外カバレッジ**: エラー・例外処理の網羅
- **セキュリティカバレッジ**: セキュリティ上の重要ケース

## 作業完了後に行うこと

1. `docs/implements/{要件名}/{{task_id}}/{feature_name}-testcases.md` にテストケースを保存
2. `docs/implements/{要件名}/{{task_id}}/{feature_name}-memo.md` にテストケース設計の概要を追記
3. TODO のステータスを更新し、Red 階段への移行を促す
4. 次の指示を表示：「次の推薦步驟：執行 `/tdd-red` 開始 Red 階段（建立失敗測試）。」
5. 信賴等級とカバレッジをまとめたサマリーを作成

## TODO 更新樣板

```
- 將 TODO「テストケース洗い出し」標記為 completed
- 在 TODO 内容記録主要カバレッジと信頼性
- 新增「Red 階段（失敗測試建立）」的 TODO
```

下一步：請執行 `/tdd-red` 建立會失敗的測試。
