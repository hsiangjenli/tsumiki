---
description: 為 TDD 開發篩選測試案例。根據整理過的需求找出完整的測試案例。
---
你是測試設計負責人。請檢視指定 task_id 的需求，並建立具高度覆蓋率的測試案例。

# TDD 測試案例篩選

根據剛整理的需求，列出能充分涵蓋需求與功能的測試案例。

## 前置準備

請先整理開發脈絡：

1. **讀取追加規範**
   - 若存在 `docs/rule` 目錄，請讀取
   - 若存在 `docs/rule/tdd` 目錄，請讀取  
   - 若存在 `docs/rule/tdd/testcases` 目錄，請讀取
   - 讀取各目錄內所有檔案並作為追加規範套用

2. **使用 @agent-symbol-searcher 搜尋測試相關資訊並讀取**
   - 搜尋既有測試樣式與測試案例，並使用 Read 工具讀取對應測試檔案
   - 找出類似功能的測試方式與模擬策略，並使用 Read 工具讀取相關檔案
   - 確認測試框架的使用方式，並讀取設定檔

3. **直接讀取相關檔案**
   - `docs/implements/{要件名}/{{task_id}}/{feature_name}-memo.md`：確認既有開發紀錄
   - `docs/implements/{要件名}/{{task_id}}/{feature_name}-requirements.md`：確認需求定義
   - `docs/implements/{要件名}/{{task_id}}/{feature_name}-testcases.md`：確認既有測試案例
   - 視需要讀取相關設計文件與任務檔案

完成讀取後，依據已準備的脈絡資訊開始篩選測試案例。

## 信賴等級指引

為每個測試案例加上註解，說明其與原始資料（需求定義、既有實作、程式庫文件等）的對照狀態：

- 🔵 **藍燈**：幾乎完全依據原始資料，無須推測
- 🟡 **黃燈**：根據原始資料合理推測
- 🔴 **紅燈**：原始資料中無對應內容，需自行推測

## 測試案例分類

### 1. 正常情境（基本運作）

請以下列格式描述：

- **測試名稱**：{清楚易懂的名稱}
  - **測試重點**：{此測試要驗證的具體行為或功能}
  - **預期行為**：{應正常執行的流程}
- **輸入值**：{具體輸入資料}
  - **輸入意義**：{為何選用此輸入、對應情境}
- **預期結果**：{具體期待值}
  - **理由**：{為何判定此結果正確}
- **測試目的**：{驗證重點}
  - **檢查要點**：{需特別留意的部分}
- 🔵🟡🔴 註記信賴等級

### 2. 異常情境（錯誤處理）

- **測試名稱**：{清楚易懂的名稱}
  - **異常概述**：{預期發生的異常情境}
  - **錯誤處理的重要性**：{為何需要此錯誤處理}
- **輸入值**：{不合法或超出邊界的數值}
  - **不合法原因**：{判定為異常的理由}
  - **實際情境**：{真實環境中可能的發生場景}
- **預期結果**：{適當的錯誤訊息或例外}
  - **錯誤訊息內容**：{訊息是否易於理解}
  - **系統安全性**：{錯誤發生時系統能否維持安全狀態}
- **測試目的**：{檢查錯誤處理}
  - **品質觀點**：{此測試對品質的貢獻}
- 🔵🟡🔴 註記信賴等級

### 3. 邊界值（最小值、最大值、Null 等）

- **測試名稱**：{清楚易懂的名稱}
  - **邊界值意義**：{為何此值重要}
  - **邊界行為保障**：{確認邊界附近的穩定度}
- **輸入值**：{邊界值}
  - **選用依據**：{為何將此值視為邊界}
  - **實務情境**：{邊界值在實務中的影響}
- **預期結果**：{邊界下的系統動作}
  - **精確性**：{計算或處理是否精準}
  - **一致性**：{邊界內外的動作是否一致}
- **測試目的**：{驗證邊界條件}
  - **穩健性**：{系統在極端條件下是否穩定}
- 🔵🟡🔴 註記信賴等級

## 開發語言與框架

請同時指定實作時使用的語言與測試框架：

- **程式語言**：{{language}}
  - **選擇理由**：{為何選擇此語言}
  - **測試優勢**：{此語言對測試的優點}
- **測試框架**：{{test_framework}}
  - **選擇理由**：{為何選擇此框架}
  - **執行環境**：{預期運行測試的環境}
- 🔵🟡🔴 註記信賴等級

## 測試案例註解指引（程式碼內）

實作測試時，請在各區塊加入以下繁體中文註解，以便追蹤設計意圖：

### 測試案例開頭

```javascript
// 【測試目的】：以繁體中文描述此測試要確認的重點
// 【測試內容】：說明測試流程或操作步驟
// 【預期行為】：說明預期結果
// 🔵🟡🔴 本測試信賴等級：標記可靠度
```

### Given（準備階段）

```javascript
// 【測試資料準備】：說明為何選擇這組資料
// 【初始條件設定】：描述測試前的狀態
// 【前置條件確認】：列出必須成立的條件
```

### When（操作階段）

```javascript
// 【操作內容】：描述執行的操作
// 【操作對象】：列出操作所作用的物件或模組
// 【操作理由】：說明操作與測試目的的關聯
```

### Then（驗證階段）

```javascript
// 【預期值】：列出期待的值或狀態
// 【檢查項目】：寫明要驗證的具體項目
// 【結果解讀】：說明該結果代表的意義
```

## 測試案例紀錄模板

`docs/implements/{要件名}/{{task_id}}/{feature_name}-testcases.md` 應使用以下格式：

```markdown
# 測試案例定義：{feature_name}

## 概要
- 功能名稱：{功能名稱}
- 預期使用者：{使用者族群}
- 開發目標：{開發對象或模組}
- 語言／框架：{使用語言與測試框架}

## 測試分類
- 正常情境：{件數}
- 異常情境：{件數}
- 邊界案例：{件數}
- E2E：{件數}
- 單元測試：{件數}

## 測試案例清單

### 正常情境
1. **測試名稱**：{名稱}
   - 測試重點：{重點描述}
   - 輸入：{輸入資料}
   - 預期結果：{期待的系統行為}
   - 信賴等級：🔵/🟡/🔴

### 異常情境
1. **測試名稱**：{名稱}
   - 異常概述：{情境描述}
   - 輸入：{輸入資料與原因}
   - 預期結果：{錯誤訊息或處理}
   - 信賴等級：🔵/🟡/🔴

### 邊界案例
1. **測試名稱**：{名稱}
   - 邊界條件：{數值或情境}
   - 輸入：{邊界值}
   - 預期結果：{系統行為}
   - 信賴等級：🔵/🟡/🔴

### 其他（必要時新增）
- 性能測試、可用性測試、安全性測試等特殊案例

## 覆蓋率檢查
- 需求對應表：列出需求與測試案例的對應關係
- 覆蓋率統計：顯示各分類的覆蓋率
- 未涵蓋需求：列出尚未覆蓋的需求與原因

## 備註
- 開發注意事項
- 待確認問題
- 後續追蹤項目
```

撰寫完成後，請提醒開發者：
- 必須以 TDD 流程逐一實作與驗證
- 測試失敗時需修正需求／實作或追加案例
- 若後續發現需求變動，務必同步更新測試案例紀錄
