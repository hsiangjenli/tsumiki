---
description: 從既有程式碼與資源逆向產出技術設計文件，包含架構、資料流程、型別介面、資料庫與 API 規格。
---

# rev-design

## 目的

分析現有程式碼後逆向整理設計文件，重建架構全貌並補齊缺漏。

## 前提

- 可存取程式碼、設定、測試
- `docs/reverse/` 已存在（沒有請建立）
- 建議先產出 `rev-tasks`

## 流程

1. **蒐集檔案**：使用 @agent-symbol-searcher 搜尋架構、設定、資料庫、API、UI、測試等檔案。
2. **分析架構**：辨識前後端模組、服務邊界、共用元件、部署拓樸。
3. **建立資料流程**：以 Mermaid 描述使用者、系統、資料來源的互動與處理流程。
4. **整理介面／型別**：從程式碼與 schema 提取 TypeScript 介面或等效定義。
5. **逆向資料庫結構**：從 migration、schema 及 ORM 定義推導資料表與關聯。
6. **整理 API 規格**：列出端點、方法、參數、回應、錯誤處理。
7. **記錄推論來源**：每項結論皆附檔案位置與信賴等級（🔵/🟡/🔴）。

## 輸出

於 `docs/reverse/{要件名}/` 建立：
- `{要件名}-architecture.md`
- `{要件名}-dataflow.md`
- `{要件名}-interfaces.ts`
- `{要件名}-database-schema.sql`
- `{要件名}-api-endpoints.md`

各檔案結構可仿照 `kairo-design` 的格式，並在章節中註明來源與信賴等級。

## 品質檢查

- 確認資料流、API、資料庫描述彼此一致
- 列出無法確認之部分與建議追蹤工作

## 後續

- 將逆向文件提供給團隊確認
- 與 `rev-requirements`、`rev-specs` 對照補齊需求
