---
mode: agent
---
---
description: 針對已存在的需求定義進行新增或修改，更新 EARS 需求與 GWT 驗收描述，並規劃對 GitHub Issue/PR 的後續動作。
---

# requirements-change

## 目的

當專案已經擁有需求文件，但使用者提出新增或調整時，協助辨識影響範圍、更新 EARS 需求與 GWT 驗收描述，並整理後續在 GitHub 上應採取的 Issue、PR 或文件更新步驟。

## Input

- 需要處理的 GitHub Issue（編號與連結），或明確說明若為新建議變更
- 使用者提供的變更摘要（為何要改、期望成果、優先順序）
- 相關文件位置（既有需求、驗收、設計、程式碼等路徑）
- 任何受影響的 CI/CD 規則或部署需求（若有）
- 已知的時間限制或交付時程

## Output

- 變更摘要與資料來源清單（含 Issue 連結與信賴等級）
- 更新後的 EARS 需求與對應的狀態標示（新增／修改／沿用）
- 更新或新增的 GWT 驗收描述
- 影響分析：需同步更新的文件、程式碼、測試、CI/CD 項目
- 建議建立或更新的 GitHub Issue／PR 內容（標題、標籤、重點）與分支命名／Commit 範例
- 後續建議指令（如 `design`、任務拆解或實作相關模板）與待確認事項

## 前提

- `docs/spec/` 目錄內已有既定的需求文件（例如 `*-requirements.md`、`*-acceptance-criteria.md`）。
- 可讀取 `CHANGELOG.md`、Git 提交歷史與相關 GitHub Issue／評論。
- 使用者能描述此次變更的背景、優先順序與預期交付時間。

## 執行流程

1. **蒐集上下文**
   - 讀取既有需求文件、驗收標準、使用者故事，確認最新版本與版本號。
   - 檢視 `CHANGELOG.md` 或最近的 Git 提交訊息，了解近期調整。
   - 擷取與需求相關的 GitHub Issue、主要留言（若無法存取，請要求使用者提供重點摘要）。
   - 若存在設計或實作文件（`docs/design/`、`docs/impl/` 等），確認可能受影響範圍。

2. **釐清變更範圍（與使用者一問一答）**
   - 變更或新增的功能描述、動機、優先順序。
   - 影響對象（使用者角色、系統邊界、外部整合）。
   - 是否影響非功能需求或 CI/CD 流程。
   - 期望的交付形式（更新文件、建立 Issue、產出 PR 草稿等）。

3. **影響分析**
   - 列出受影響的 EARS 需求條目（新增、修改、刪除），並標註信賴等級 🔵🟡🔴。
   - 為每個功能變更撰寫或調整 GWT（Given-When-Then）驗收描述。
   - 分析非功能需求、設計文件、測試案例是否需要同步更新。
   - 評估是否需要新增/調整 CI/CD 工作或檢查。

4. **變更方案草稿**
   - 以 Markdown 匯總：
     - 變更摘要與動機。
     - 更新後的 EARS 需求列表（標示新增、修改、沿用）。
     - 對應的 GWT 驗收表格或清單。
     - 影響分析（文件、程式碼、測試、CI/CD）。
   - 提供 GitHub Issue 建議內容（標題、標籤、內文要點）或直接建議更新既有 Issue。
   - 若需 PR，給出分支命名、Commit Message 模板與主要檔案路徑。

5. **輸出與下一步**
   - 彙整為 Markdown 段落：
     - 專案現況摘要與資料來源。
     - 更新後的 EARS / GWT 清單。
     - 建議建立或更新的 Issue / PR。
     - 建議使用的後續 Prompt（例如 `design`、任務拆解或實作模板）。
   - 明確指出需人工確認的問題或待決策事項。

## 注意事項

- 任何新的或修改後的需求都必須同時提供 EARS 敘述與 GWT 驗收描述。
- 若資訊不足，請直接向使用者追問；不得自行臆測。
- 請使用繁體中文回應；若 MCP 或其他自動化工具可用，請主動建立／更新 GitHub Issue 留存輸出，無法存取時再請使用者協助。
