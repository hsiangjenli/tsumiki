---
mode: agent
description: 總驗證 TDD 迭代成果，確認測試、契約、品質檢查皆達標並回報結果
inputs:
  summary: 使用本 Prompt 進行 Verify / Complete 階段的檢查與回報
  required:
    - 目標 TDD Issue 與最新測試矩陣
    - Red / Green / Refactor 階段的輸出摘要與待辦
    - 必須通過的測試指令、CI/CD 流程與品質守門清單
    - 需要同步驗證的契約、文件、監控設定
    - 語言與輸出格式偏好（預設繁體中文 + Markdown）
outputs:
  summary: 出具驗證結果報告，判定是否結束 TDD 迭代或需重新循環
  include:
    - 測試與品質檢查結果（通過 / 未通過詳情）
    - 契約 / 文件是否更新完成
    - 若未達標，列出需返回哪個階段（Red / Green / Refactor）的理由
    - 建議後續動作：提交 PR、更新 Issue、建立新任務等
---

# tdd-verify

## 目的

在完成 Red→Green→Refactor 後，執行最終驗證，確認所有測試與品質檢查通過、契約與文件同步更新，並決定是否結束本次 TDD 迭代或回到先前階段。

## 流程

### Phase 0：檢查清單建立
1. 根據 TDD Issue 測試矩陣列出所有需驗證的測試項目與指令。
2. 列出品質守門檢查：Lint、型別、Coverage、靜態分析、資安掃描等。
3. 確認契約、文件、監控設定是否需要更新或驗證。

### Phase 1：執行驗證
1. 逐項執行測試與檢查，記錄輸出與結果。
2. 若有未通過項目，詳細描述錯誤訊息、影響範圍與建議回到哪個階段處理。
3. 確認契約檔案或文件是否與 SDD 一致，若需補件，記錄路徑與負責人。

### Phase 2：判定與回報
1. 若全部通過，整理驗證摘要、耗時、關鍵指標，標示「合格」。
2. 若有未通過項目，標示「需持續迭代」，列出回到 Red / Green / Refactor 的建議與原因。
3. 提醒在 TDD Issue 更新測試矩陣與狀態，並附上驗證輸出或 CI 連結。
4. 建議後續動作（建立 PR、通知 reviewer、更新 changelog 等）。

## 產出格式建議

- **驗證結果表**：項目、指令 / 工具、結果、備註。
- **契約 / 文件同步清單**：是否已更新、連結、待補事項。
- **決策摘要**：合格或需再迭代的結論與下一步。

## 後續建議

- 若需再次迭代，建議立即回到指定階段並更新 TDD Issue。
- 合格後，可啟動實作 PR 流程或進入更高層級測試。
- 在輸出末尾提醒使用者確認 TDD Issue 已留存完整驗證記錄。
