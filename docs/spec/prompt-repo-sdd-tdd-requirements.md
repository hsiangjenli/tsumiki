# prompt-repo-sdd-tdd 要件定義書

## 概要
打造一個專屬的 prompt repo，讓不懂技術的使用者能夠通過自然語言描述需求，AI 協助生成結構化的 SDD (Specification-Driven Development) 和 TDD (Test-Driven Development) 開發流程。系統以純 markdown 格式儲存所有 prompt 內容，使用 git 進行版本控制，重點在於設計高品質、可重用的 prompt 範本。

## 設計考量

### 技術堆疊偏好
- **儲存格式**：純 Markdown（參考 commands/ 目錄結構）
- **版本控制**：Git（分支管理、歷史追蹤）
- **組織方式**：目錄結構化分類
- **內容格式**：標準 Markdown + YAML frontmatter

### 系統邊界
- **核心功能**：Prompt 內容設計與組織
- **外部依賴**：Git 版本控制系統
- **資料流程**：需求分析 → Prompt 設計 → Markdown 文件 → Git 提交

### 關鍵設計決策
- **文件格式**：Markdown（易讀、可編輯、版本控制友好）
- **組織結構**：類似 commands/ 目錄的分類方式
- **內容重點**：Prompt 品質而非系統複雜度
- **擴展性**：易於新增 prompt 類型和分類

## 功能需求（EARS 記法）

**信賴等級：** 🔵 確定、🟡 推測、🔴 猜測

### 通常需求
- REQ-001：系統必須以純 Markdown 格式儲存所有 prompt 內容，參考 commands/ 目錄的結構和格式 🔵 *使用者確認*
- REQ-002：系統必須使用 Git 進行版本控制，支援分支管理、提交歷史和協作開發 🔵 *使用者確認*
- REQ-003：系統必須提供類似 kairo-requirements 的功能，蒐集與分析現有專案資訊，向使用者進行需求訪談，並使用 EARS 記法整理成含驗收標準的需求定義書 🔵 *kairo-requirements.prompt.md*
- REQ-004：系統必須設計高品質的 prompt 範本，包含清晰的執行流程、輸出格式和品質標準 🔵 *commands/ 目錄分析*
- REQ-005：系統必須支援多種類型的 prompt（需求定義、設計、實作、測試等），每個 prompt 都有明確的用途和適用場景 🔵 *commands/ 目錄結構*

### 條件式需求
- REQ-101：當設計新的 prompt 時，系統必須包含完整的 YAML frontmatter，定義用途、參數和輸出格式 🔵 *commands/ 目錄格式*
- REQ-102：當 prompt 涉及多步驟流程時，系統必須清晰定義每個階段的輸入輸出和驗證標準 🔵 *kairo-requirements.prompt.md 分析*
- REQ-103：當 prompt 需要處理複雜需求時，系統必須提供一問一答的互動模式和錯誤處理機制 🔵 *訪談確認*

### 狀態需求
- REQ-201：處於需求定義階段時，系統必須使用 EARS 記法整理功能需求和驗收標準 🔵 *kairo-requirements.prompt.md*
- REQ-202：處於設計階段時，系統必須生成結構化的設計文件和技術決策記錄 🔵 *設計文件分析*
- REQ-203：處於實作階段時，系統必須提供 TDD 流程指導和程式碼品質標準 🔵 *tdd-*.md 文件分析*

### 可選需求
- REQ-301：系統可以支援 prompt 的參數化配置，允許根據不同專案調整 prompt 行為 🔵 *commands/ 目錄分析*
- REQ-302：系統可以提供 prompt 組合功能，將多個相關 prompt 組織成完整的開發流程 🔵 *kairo 系列 prompt 分析*

### 限制需求
- REQ-401：系統必須只使用 Markdown 格式，不得包含任何程式碼實作 🔵 *使用者確認*
- REQ-402：系統必須依賴 Git 進行版本控制，不得實作自定義的版本管理功能 🔵 *使用者確認*
- REQ-403：系統不得涉及任何部署或執行環境，重點完全在於 prompt 內容設計 🔵 *使用者確認*
- REQ-201：處於需求蒐集階段時，系統必須提供引導性問題幫助使用者完善描述 🔵 *訪談確認*
- REQ-202：處於開發執行階段時，系統必須從 GitHub Issue 中提取 TDD 任務供 AI 開發者使用 🔵 *訪談確認*
- REQ-203：處於驗收階段時，系統必須根據 TDD 測試案例驗證實作是否符合需求 🔵 *訪談確認*

### 可選需求
- REQ-301：系統可以生成開發進度報表，顯示任務完成率和時間統計 🔵 *訪談確認*
- REQ-302：系統可以生成品質分析報表，包含測試覆蓋率和靜態動態掃描結果 🔵 *訪談確認*
- REQ-303：系統可以生成需求追蹤報表，顯示需求實現狀態和變更歷史 🔵 *訪談確認*
- REQ-304：系統可以提供自動備份功能，保護 prompt 模板和專案資料 🔵 *訪談確認*
- REQ-305：系統可以提供使用者支援系統，包含說明文件和回饋處理 🔵 *訪談確認*

### 限制需求
- REQ-401：系統必須確保所有產出的文件和 Issue 符合 GitHub 標準格式和最佳實務 🔵 *訪談確認*
- REQ-402：系統必須保護使用者輸入的敏感資訊，不得洩露到公開的 GitHub Issue 中 🔵 *訪談確認*
- REQ-403：系統必須支援現有 Tsumiki 架構，可以參考但需打造符合個人開發流程的自定義系統 🔵 *訪談確認*
- REQ-404：系統必須支援 JavaScript/TypeScript、Python 和 Java 三種主要程式語言，提供語言特定的品質分析和測試覆蓋標準 🔵 *訪談確認*
- REQ-405：系統必須限制單次需求描述長度不超過 10000 字元，超過時自動建議分割處理 🔵 *訪談確認*
- REQ-406：系統必須限制並發處理的專案數量不超過 10 個，以確保效能和資源使用合理 🔵 *訪談確認*

## 非功能需求

### 效能
- NFR-001：系統回應時間必須小於 30 秒，即使在處理複雜需求描述時 🔵 *推測基準*
- NFR-002：系統必須支援同時處理多個專案的需求生成而不影響效能 🔵 *推測基準*
- NFR-003：系統記憶體使用量必須控制在 500MB 以內，避免影響開發環境效能 🔵 *推測基準*
- NFR-004：GitHub API 呼叫頻率必須控制在合理範圍內，避免觸發 API 限制 🔵 *推測基準*

### 安全
- NFR-101：系統必須保護使用者資料和專案資訊，符合一般資料保護標準，並根據專案使用的程式語言提供相應的安全實務建議 🔵 *訪談確認*
- NFR-102：系統必須驗證 GitHub API 存取權限，防止未授權的操作 🔵 *推測基準*

### 使用性
- NFR-201：系統必須提供直觀的對話式介面，讓不懂技術的使用者也能輕鬆描述需求 🔵 *訪談確認*
- NFR-202：系統必須提供清晰的狀態指示，讓使用者知道目前處於哪個開發階段 🔵 *訪談確認*

## Edge Case

### 錯誤處理
- EDGE-001：當使用者輸入完全無法解析的需求描述時，系統必須提供具體的範例和引導問題 🔵 *推測基準*
- EDGE-002：當 GitHub API 呼叫失敗時，系統必須提供重試機制和錯誤說明 🔵 *推測基準*
- EDGE-003：當多輪對話超過合理時間限制時，系統必須建議暫停並儲存進度 🔵 *推測基準*

### 邊界值
- EDGE-101：當需求描述極其簡短（少於 10 字）時，系統必須要求更多細節 🔵 *推測基準*
- EDGE-102：當需求描述極其複雜（超過 5000 字）時，系統必須建議分階段處理 🔵 *推測基準*
- EDGE-103：當 GitHub Issue 數量超過專案限制時，系統必須提供分批處理的解決方案 🔵 *推測基準*
- EDGE-104：當多個專案同時要求生成時，系統必須按優先順序排隊處理 🔵 *推測基準*
- EDGE-105：當 GitHub API 權限不足時，系統必須提供清晰的權限設定指引 🔵 *推測基準*

## TODO 更新

**狀態**：需求定義完成 ✅
**下一步**：執行 `kairo-design` 產出設計文件

### 設計文件待產生
- `docs/design/prompt-repo-sdd-tdd/architecture.md`：系統架構設計
- `docs/design/prompt-repo-sdd-tdd/dataflow.md`：資料流程圖  
- `docs/design/prompt-repo-sdd-tdd/interfaces.ts`：TypeScript 介面定義
- `docs/design/prompt-repo-sdd-tdd/database-schema.sql`：資料庫結構（若需要）
- `docs/design/prompt-repo-sdd-tdd/api-endpoints.md`：API 規格
