# prompt-repo-sdd-tdd 架構設計

## 核心理念
prompt-repo-sdd-tdd 的重點在於整理高品質 Prompt 文件。當人類提出需求時，只要挑選合適的模板交給 AI，LLM 即可依腳本展開訪談、產出文件，並視需要協助建立 GitHub Issue、PR 或程式碼。整體流程為「人類描述需求 → 選用 Prompt 模板 → AI 依模板執行 → GitHub 紀錄成果」，必要時仍可同步輸出到本機檔案供人工調整。

## 模板選擇指南
- **入口指令建議**：提供 `kairo-overview` 或 `prompt-index` 類模板，快速評估使用者需求並回傳推薦指令清單。
- **決策樹文件**：維護 `docs/design/prompt-repo-sdd-tdd/template-map.md`（或同等索引），描述常見情境與對應模板，例如：
  - 需求模糊 → 使用 `kairo-requirements`
  - 需求已確認，需技術設計 → 使用 `kairo-design`
  - 需要拆分任務 → 使用 `kairo-tasks`
  - 進入 TDD 實作 → 使用 `tdd-*` 系列
- **模板內指示下一步**：每份 Prompt 結尾明示「完成後請執行 ___ 指令」與備選路徑，讓 LLM 能向使用者建議後續動作。
- **命令太多時的 AI 協助**：鼓勵使用者先執行入口模板，由 AI 根據需求內容與已完成的階段自動推薦下一個指令。

## 主要參與者
- **非技術使用者**：以自然語言描述需求、回答 AI 追問。
- **Prompt 套件（本專案）**：提供各階段的標準化模板與操作守則。
- **LLM 助手**：讀取 Prompt，執行訪談、文件生成、Issue/PR 建立及 CI/CD 指令建議。
- **GitHub 儲存庫**：成果的第一順位歸宿（Issue、PR、程式碼）；同時允許在本機保存 Markdown 草稿以配合人工審閱。

## 基本流程
1. **需求輸入**：使用者描述目標、限制與偏好。
2. **模板建議**：依決策樹或入口模板推薦下一步指令，減少使用者自行猜測的成本。
3. **AI 執行**：LLM 依模板規範進行提問、產出內容、執行檢查，並回報需要人工決策的項目。
4. **結果檢視**：回傳 Markdown 文件或 Issue/PR 草稿，標示信賴等級、資料來源與待確認事項。
5. **GitHub 更新**：以建立 Issue 為原則記錄成果，如需 PR 或分支命名、CI/CD 指令也由模板指示；若流程要求，可在本機同步檔案以供版本控制或審查。
6. **後續串連**：每個模板結尾皆提示下個推薦指令或選項，確保 SDD/TDD 流程連貫。

## Prompt 組織與職責
- **需求蒐集模板（kairo-requirements）**：以 EARS 格式整理需求、列出驗收標準、CI/CD 注意事項，並提示後續設計步驟。
- **需求變更模板（requirements-change）**：在既有需求需新增或調整時更新 EARS 與 GWT，並規劃 GitHub Issue／PR 的變更流程。
- **設計模板（kairo-design）**：依需求輸出資料流程、介面定義、API/CI/CD 指南等文件以及 Issue 建議。
- **任務拆解模板（kairo-tasks）**：把需求轉為開發任務，提供 Issue 標題、內容、標籤與流水線任務設定。
- **實作支援模板（kairo-implement、tdd-*）**：引導 LLM 依 TDD 或其它規範撰寫測試、程式碼與部署指令，並檢查 CI/CD 狀態。

每份 Prompt 文件應包含：
- 功能目標與適用情境
- 詳盡對話腳本、輸出欄位與驗證步驟
- Markdown/Issue/PR 的格式規範、信賴等級標示
- GitHub 操作與 CI/CD 規範（分支命名、Commit/PR 模板、pipelines、必要指令）
- 與其他模板的銜接方法、選項與相容性備註

## GitHub 與檔案策略
- Prompt 以建立或更新 GitHub Issue 為優先，確保輸出可被追蹤；同時提供在本機保存 Markdown 的指南，供離線或人工審核。
- 模板規範 Issue/PR 標題、內容、標籤與 Pipeline 觸發條件，並提供最小化可行的命令範例。
- 若需提交程式碼，模板指定分支命名與 Commit Message 格式，並提醒檢查 CI/CD 結果。

## 非功能考量
- **一致性**：所有模板維持相同骨架與語言風格，降低 LLM 理解差異。
- **透明性**：要求 AI 標示資料來源、推測程度（🔵🟡🔴），並回報是否符合 CI/CD 規範。
- **可維護性**：透過 Git 管理模板版本，記錄改動與測試結果；專用模板可依統一規約擴充。
- **易採用**：無需額外後端或資料庫，在任何支援 Markdown 與 GitHub 的環境中即可使用。

## 擴充方向
- 設計跨領域可共用的專用模板，並建立索引機制讓入口指令可推薦新模板。
- 建立 Prompt Lint / 自動評分工具，檢查是否涵蓋 CI/CD 要求與流程銜接。
- 與更多自動化服務整合（如 CI 管線、Issue Boards、知識庫同步），強化模板指示的執行力。
